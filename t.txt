"""
Main file. Probably the backbone idk.
"""

import os
from dotenv import load_dotenv
from groq import Groq
import sqlite3


load_dotenv()
client = Groq(api_key=os.environ.get("GROQ_API_KEY"))
system_prompt = {
    "role": "system",
    "content": os.environ.get("prompt"),
}

chat_history = [system_prompt]
def load_chat_history():
    conn = sqlite3.connect("history.db")
    query = "SELECT name from sqlite_master WHERE type='table' AND name='HISTORY';"
        cursor = conn.execute(query)
        result = cursor.fetchone()
        if result == None:
            
        else:
            return True
        
    conn.execute('''CREATE TABLE HISTORY
                 (ID PRIMARY KEY INT,
                 MESSAGE TEXT
				);'''
    )
    

    conn.execute('''CREATE TABLE HISTORY
                 (ID PRIMARY KEY INT,
                 MESSAGE TEXT
				)'''
    )


def ai_response(chat_history):
    # Get user input from the console
    user_input = input("You: ")

    # Append the user input to the chat history
    chat_history.append({"role": "user", "content": user_input})

    response = client.chat.completions.create(
        model="llama3-70b-8192", messages=chat_history, max_tokens=100, temperature=1.2
    )
    # Append the response to the chat history
    chat_history.append(
        {"role": "assistant", "content": response.choices[0].message.content}
    )
    # Print the response
    print("Assistant:", response.choices[0].message.content)


while True:
    ai_response(chat_history)
